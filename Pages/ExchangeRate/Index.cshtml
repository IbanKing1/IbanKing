@page
@model IBanKing.Pages.ExchangeRate.IndexModel
@{
    ViewData["Title"] = "Exchange Rates";
    Layout = "_LayoutClient";
}

<link rel="stylesheet" href="~/css/exchange-rate.css" asp-append-version="true" />

<div class="exchange-container">
    <h1 class="text-center mb-4">Currency Exchange</h1>

    <div class="currency-converter">
        <div class="converter-header">
            <h2 class="converter-title">Currency Converter</h2>
        </div>

        <form id="conversionForm">
            <div class="currency-inputs">
                <div class="currency-input-group">
                    <label for="amount">Amount</label>
                    <input type="number" id="amount" class="currency-amount" value="1" min="0.01" step="0.01">
                </div>

                <div class="currency-input-group">
                    <label for="fromCurrency">From</label>
                    <select id="fromCurrency" class="currency-select">
                        @foreach (var currency in Model.LiveRates.Keys)
                        {
                            <option value="@currency" selected="@(currency == "EUR")">@currency</option>
                        }
                    </select>
                </div>

                <button type="button" id="swapCurrencies" class="swap-currencies" title="Swap currencies">
                    ⇄
                </button>

                <div class="currency-input-group">
                    <label for="toCurrency">To</label>
                    <select id="toCurrency" class="currency-select">
                        @foreach (var currency in Model.LiveRates.Keys)
                        {
                            <option value="@currency" selected="@(currency == "USD")">@currency</option>
                        }
                    </select>
                </div>
            </div>

            <button type="submit" id="convertButton" class="btn btn-primary">Convert</button>
        </form>

        <div id="conversionResult" class="converter-result" style="display: none;">
            <div class="result-text">
                <div id="result"></div>
                <div class="rate-info" id="rate"></div>
            </div>
        </div>
    </div>

    <div class="favorites-section">
        <div class="favorites-header">
            <h2 class="favorites-title">Favorite Currency Pairs</h2>
            <button id="editFavorites" class="edit-favorites">Edit Favorites</button>
        </div>

        <div id="favoritesContainer" class="favorites-grid"></div>
    </div>

    <div class="chart-section">
        <h2 class="mb-3">Exchange Rate History</h2>
        <div class="chart-container">
            <canvas id="exchangeChart"></canvas>
        </div>
    </div>
</div>

<div id="editModal" class="edit-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Edit Favorite Currencies</h3>
            <button id="closeModal" class="close-modal">×</button>
        </div>

        <div class="search-box">
            <input type="text" id="currencySearch" placeholder="Search currencies...">
            <span class="search-icon">🔍</span>
        </div>

        <div id="availableCurrencies" class="available-currencies"></div>

        <div class="modal-actions">
            <button id="cancelEdit" class="btn btn-secondary">Cancel</button>
            <button id="saveFavorites" class="btn btn-primary">Save</button>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="~/js/exchange-rate.js" asp-append-version="true"></script>
}